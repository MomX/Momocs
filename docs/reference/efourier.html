<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Elliptical Fourier transform — efourier • Momocs</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Momocs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Momocs_cheapbabi.html">Momocs cheapbabi</a>
    </li>
    <li>
      <a href="../articles/Momocs_speed_dating.html">Momocs speed dating</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vbonhomme/Momocs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Elliptical Fourier transform</h1>
    </div>

    
    <p><code>efourier</code> computes Elliptical Fourier Analysis (or Transforms or EFT)
from a matrix (or a list) of (x; y) coordinates.</p>
    

    <pre class="usage"><span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='no'>nb.h</span>, <span class='kw'>smooth.it</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for Out</span>
<span class='fu'>efourier</span>(<span class='no'>x</span>, <span class='no'>nb.h</span>, <span class='kw'>smooth.it</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>norm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code>list</code> or a <code>matrix</code> of coordinates or a <code>Out</code> object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>useless here</p></td>
    </tr>
    <tr>
      <th>nb.h</th>
      <td><p><code>integer</code>. The number of harmonics to use. If missing, 12 is used on shapes;
99 percent of harmonic power on Out objects, both with messages.</p></td>
    </tr>
    <tr>
      <th>smooth.it</th>
      <td><p><code>integer</code>. The number of smoothing iterations to
perform.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code>. Whether to print or not diagnosis messages.</p></td>
    </tr>
    <tr>
      <th>norm</th>
      <td><p>whether to normalize the coefficients using <a href='efourier_norm.html'>efourier_norm</a></p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>logical whether to consider the first point as homologous</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with these components:</p>
<dt>an </dt><dd><p><code>vector</code> of
\(a_{1-&gt;n}\) harmonic coefficients.</p></dd> <dt>bn </dt><dd><p><code>vector</code> of
\(b_{1-&gt;n}\) harmonic coefficients.</p></dd> <dt>cn </dt><dd><p><code>vector</code> of
\(c_{1-&gt;n}\) harmonic coefficients.</p></dd> <dt>dn </dt><dd><p><code>vector</code> of
\(d_{1-&gt;n}\) harmonic coefficients.</p></dd> <dt>ao </dt><dd><p><code>ao</code> Harmonic
coefficient.</p></dd> <dt>co </dt><dd><p><code>co</code> Harmonic coefficient.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the maths behind see the paper in JSS.</p>
<p>Normalization of coefficients has long been a matter of trouble,
and not only for newcomers. There are two ways of normalizing outlines: the first,
and by far the msot used, is to use a "numerical" alignment, directly on the
matrix of coefficients. The coefficients of the first harmonic are consumed
by this process but harmonics of higher rank are normalized in terms of size
and rotation. This is sometimes referred as using the "first ellipse", as the
harmonics define an ellipse in the plane, and the first one is the mother of all
ellipses, on which all others "roll" along. This approach is really convenient
as it is done easily by most software (if not the only option) and by Momocs too.
It is the default option of <code>efourier</code>.</p>
<p>But here is the pitfall: if your shapes are prone to bad aligments among all
the first ellipses, this will result in poorly (or even not at all) "homologous" coefficients.
The shapes prone to this are either (at least roughly) circular and/or with a strong
bilateral symmetry. You can try to use <code>stack</code> on the <code><a href='Coe.html'>Coe</a></code> object
returned by <code>efourier</code>. Also, when plotting PCA using Momocs,
this will be strikingly clear though. This phenomenon will result in two clusters,
and more strikingly into upside-down (or 180 degrees rotated)
shapes on the morphospace. If this happen, you should seriously consider
aligning your shapes <em>before</em> the <code>efourier</code> step,
and performing the latter with no normalization (<code>norm = FALSE</code>), since
it has been done before.</p>
<p>You have several options to align your shapes, using control points (or landmarks),
of Procrustes alignment (see <code><a href='fgProcrustes.html'>fgProcrustes</a></code>) through their calliper
length (see <code><a href='coo_aligncalliper.html'>coo_aligncalliper</a></code>), etc. You should also make the first
point homologous either with <code><a href='coo_slide.html'>coo_slide</a></code> or <code><a href='coo_slidedirection.html'>coo_slidedirection</a></code>
to minimize any subsequent problems.</p>
<p>I will dedicate (some day) a vignette or a paper to this problem.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Directly borrowed for Claude (2008), and also called <code>efourier</code> there.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Claude, J. (2008) <em>Morphometrics with R</em>, Use R! series,
Springer 316 pp.
Ferson S, Rohlf FJ, Koehn RK. 1985. Measuring shape variation of
two-dimensional outlines. <em>Systematic Biology</em> <b>34</b>: 59-68.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Other efourier: <code><a href='efourier_i.html'>efourier_i</a></code>,
  <code><a href='efourier_norm.html'>efourier_norm</a></code>, <code><a href='efourier_shape.html'>efourier_shape</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>coo</span> <span class='kw'>&lt;-</span> <span class='no'>bot</span>[<span class='fl'>1</span>]
<span class='fu'><a href='coo_plot.html'>coo_plot</a></span>(<span class='no'>coo</span>)</div><div class='input'><span class='no'>ef</span> <span class='kw'>&lt;-</span> <span class='fu'>efourier</span>(<span class='no'>coo</span>, <span class='fl'>12</span>)
<span class='no'>ef</span></div><div class='output co'>#&gt; $an
#&gt;  [1] -143.1142910    5.2925309   22.9922936  -11.3596452  -14.9412217
#&gt;  [6]   -5.4200881    5.7177112    0.4509076    0.3107020   -3.1633079
#&gt; [11]    0.2814646    3.4927761
#&gt; 
#&gt; $bn
#&gt;  [1] -13.8501141 -21.8994092  11.4235084  13.5870435 -12.6401807   2.5050679
#&gt;  [7]   5.1968464  -0.5366171  -1.0431706   1.0823659   2.3427969   0.1022387
#&gt; 
#&gt; $cn
#&gt;  [1]  64.44753053  -3.15375656 -17.96822626   5.76052596   7.17390949
#&gt;  [6]  -2.98410094  -1.20013013   1.18299684  -0.36305436  -0.46782525
#&gt; [11]   0.67134872   0.08954658
#&gt; 
#&gt; $dn
#&gt;  [1] -484.90299209   -1.04774048   42.07408510    3.40654863   -9.19128141
#&gt;  [6]   -2.99359284    0.96722479    2.22582484    0.02026172   -2.26134728
#&gt; [11]   -0.04679906    0.80569603
#&gt; 
#&gt; $ao
#&gt; [1] 349.02
#&gt; 
#&gt; $co
#&gt; [1] 1080.921
#&gt; </div><div class='input'><span class='no'>efi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='efourier_i.html'>efourier_i</a></span>(<span class='no'>ef</span>)
<span class='fu'><a href='coo_draw.html'>coo_draw</a></span>(<span class='no'>efi</span>, <span class='kw'>border</span><span class='kw'>=</span><span class='st'>'red'</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>NA</span>)</div><div class='img'><img src='efourier-1.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.vincentbonhomme.fr'>Vincent Bonhomme</a>, Julien Claude.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
