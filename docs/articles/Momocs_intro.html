<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to Momocs • Momocs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="An introduction to Momocs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Momocs</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Momocs_FAQ.html">Momocs' Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/Momocs_coo.html">Operations on shapes</a>
    </li>
    <li>
      <a href="../articles/Momocs_grindr.html">Layered shape and multivariate plots with grindr</a>
    </li>
    <li>
      <a href="../articles/Momocs_intro.html">An introduction to Momocs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MomX/Momocs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An introduction to Momocs</h1>
                        <h4 class="author">Vincent Bonhomme</h4>
            
            <h4 class="date">2018-10-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MomX/Momocs//blob/master/vignettes/Momocs_intro.Rmd"><code>vignettes/Momocs_intro.Rmd</code></a></small>
      <div class="hidden name"><code>Momocs_intro.Rmd</code></div>

    </div>

    
    
<div id="news" class="section level2">
<h2 class="hasAnchor">
<a href="#news" class="anchor"></a>News</h2>
<p>As of Oct. 2018, Momocs is being extensively polished these days and may evolve before its 2.0 release as part of <a href="http://momx.online">MomX</a>.</p>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="abstract" class="section level3">
<h3 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h3>
<p>Momocs aims to provide a complete and convenient toolkit for morphometrics. It is intended for scientists interested in describing quantitatively the shape, and its (co)variations, of the objects they study.</p>
<p>In the last decade, R has become the open-source <em>lingua franca</em> for statistics, and morphometrics known its so-called “revolution”. Nevertheless, morphometric analyses still have to be carried out using various software packages either dedicated to a particular morphometric and/or for which source code is mostly unavailable and/or copyrighted. Moreover, most of existing software packages cannot be extended and their bugs are hard to detect and thus correct. This situation is detrimental to morphometrics: time is wasted, analyses are restricted to available methods, and last but not least, are poorly reproducible. This impedes collaborative effort both in software development and in morphometric studies.</p>
<p>By gathering the common morphometric approaches in an open-source environment and welcoming contributions, Momocs is an attempt to solve this twofold problem.</p>
<p>Momocs hinges on the core functions published in the must-have <em><a href="http://www.springer.com/us/book/9780387777894">Morphometrics with R</a></em> by <a href="http://www.isem.univ-montp2.fr/recherche/equipes/macroevolution-et-developpement/personnel/claude-julien/">Julien Claude</a> (2008), but has been further extended to allow other shape description systems. So far, configurations of landmarks, outlines and open outline analyses, along with some facilities for traditional morphometrics are implemented.</p>
<p>Prior to analysis, Momocs can be used to acquire and manipulate data or to import/export from/to other formats. Momocs also has the facility for a wide range of multivariate analyses and production of the companion graphics. Thus a researcher will find that just a few lines of code will provide initial results, but the methods implemented can be finely tuned and extended according to the user’s needs.</p>
<ul>
<li>If you use it, please cite it: <code>citation("Momocs")</code>.</li>
<li>This citation refers to an obsolete version of Momocs, only handling outline analyses. The next companion, encompassing all <a href="http://momx.online">MomX</a> and seminal paper is on its way.</li>
</ul>
</div>
<div id="survival-tips" class="section level3">
<h3 class="hasAnchor">
<a href="#survival-tips" class="anchor"></a>Survival tips</h3>
<ul>
<li>This vignette introduces Momocs, as for every R function, each function has its own manual page, eg <code><a href="../reference/efourier.html">?efourier</a></code>.</li>
<li>There is a much nicer <a href="http://momx.github.io/Momocs/">online version of this manual</a> that can be accessed from the console with, e.g. <code><a href="../reference/Momocs_helpers.html">Momocs_help("efourier")</a></code>.</li>
<li>Feel free to contribute to Momocs through <a href="http://www.github.com/MomX/Momocs">GitHub</a>: report issues, ask for new features, share data and methods, correct typos, write better vignettes, helpfiles, or whatever pleases you. If you have never heard of GitHub, that’s definitely worth <a href="http://r-pkgs.had.co.nz/git.html">a look</a>.</li>
<li>Feel free to drop me a line, should you need a hand or would like to collaborate with me: <code>bonhomme.vincent@gmail.com</code>.</li>
<li>Before asking for help, please read Momocs’s FAQ: <code><a href="../articles/Momocs_FAQ.html">vignette("Momocs_FAQ")</a></code>.</li>
</ul>
</div>
<div id="get-install-and-use-it" class="section level3">
<h3 class="hasAnchor">
<a href="#get-install-and-use-it" class="anchor"></a>Get, install and use it</h3>
<p>First, of all, let’s download the last version of Momocs. You will need to install the <code>devtools</code> package - if you do not have it yet - to get it from my <a href="http://www.github.com/MomX/Momocs">GitHub</a> repository :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"MomX/Momocs"</span>)</a></code></pre></div>
<p>The typical <code>install_packages("Momocs")</code> will get you the last CRAN version of Momocs, but the GitHub version is preferred as Momocs is still under active development.</p>
<p>We can start using Momocs, as long as it has been loaded using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(Momocs)</a></code></pre></div>
</div>
</div>
<div id="design" class="section level2">
<h2 class="hasAnchor">
<a href="#design" class="anchor"></a>Design</h2>
<p>Keywords used all accross Momocs are introduced here in <strong>bold</strong>.</p>
<p>Morphometrics is the ugly job of turning beautiful shapes into quantitative variables. Just kidding, that’s pretty exciting.</p>
<p>A <strong>shape</strong> is defined as a collection of <code>(x; y)</code> coordinates. No 3D yet but different <strong>families</strong> are handled by Momocs:</p>
<ol style="list-style-type: decimal">
<li>
<strong>outlines</strong>, here in a first-quarter moon ;</li>
<li>
<strong>open outlines</strong>, here is the sterile valve of an olive stone;</li>
<li>
<strong>configuration of landmarks</strong>; here, homologous points from a mosquito wing.</li>
</ol>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="Momocs_intro_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="Momocs_intro_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>They are all single shapes defined by a matrix of <code>(x; y)</code> coordinates; here are the first points of the moon:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">shapes[<span class="dv">18</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  200   50
## [2,]  199   49
## [3,]  198   49
## [4,]  197   50
## [5,]  196   50
## [6,]  195   49</code></pre>
<p>Many operations on shapes are implemented such as: plotting, geometric operations, scalar descriptions, etc. These operations have their dedicated vignette, see <code><a href="../articles/Momocs_coo.html">vignette("Momocs_coo")</a></code>.</p>
<p>Working on single shape can quicly be boring. Shapes can be organized into a collection of coordinates: a <code>Coo</code> object that carries:</p>
<ul>
<li>a component named <code>$coo</code>, a <code>list</code> of shapes (as <code>matrix</code>.ces);</li>
<li>most of the time, a component named <code>$fac</code>, a <code>data.frame</code> (or the modern equivalent, a <code>data_frame</code>) to store covariates, either <code>factor</code>s or <code>numeric</code>s;</li>
<li>possibly, other components of interest.</li>
</ul>
<p>One can do several things with a <code>Coo</code> object: visualize it, apply morphometric operations, handle the data it contains, but in the end, a __ morphometric method__ will turn coordinates into coefficients.</p>
<p>Such morphometric operation on coordinates produce a collection of coefficients: a <code>Coe</code> object that carries:</p>
<ul>
<li>a component named <code>$coe</code>, a <code>matrix</code> of coefficients;</li>
<li>if present in <code>Coo</code>, <code>$fac</code> is inherited;</li>
<li>possibly, other components of interest.</li>
</ul>
<p>This can be summarized as follows:</p>
<table class="table">
<thead><tr class="header">
<th><code>Coo</code></th>
<th>+</th>
<th>Morphometric method</th>
<th>=</th>
<th><code>Coe</code></th>
</tr></thead>
<tbody><tr class="odd">
<td>
<code>(x; y)</code> coordinates</td>
<td>+</td>
<td>appropriate method</td>
<td>=</td>
<td>quantitative variables</td>
</tr></tbody>
</table>
<p><code>Coo</code> objects are collections of coordinates that become <code>Coe</code> objects when an appropriate morphometric method is applied on them.</p>
<p>Some operations on <code>Coo</code>/<code>Coe</code> are <strong>generic</strong> in that they do not depend of the nature of the shape. For instance, centering a configuration of landmarks or an outline, or calculating their centroid size is, mathematically, the same <strong>generic</strong> operation. But some operations on shapes are <strong>specific</strong> to a peculiar family. For instance, calculating elliptical Fourier transforms on a configuration of landmarks would make no sense.</p>
<p>Momocs implement this desirable behavior and defines <strong>classes</strong> and <strong>subclasses</strong>, as S3 objects.</p>
<table class="table">
<thead><tr class="header">
<th><code>Coo</code></th>
<th>Morphometrics methods</th>
<th><code>Coe</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<code>OutCoo</code> (outlines)</td>
<td>
<code>efourier</code>, <code>rfourier</code>, <code>sfourier</code>, <code>tfourier</code>
</td>
<td><code>OutCoe</code></td>
</tr>
<tr class="even">
<td>
<code>OpnCoo</code> (open outlines)</td>
<td>
<code>npoly</code>, <code>opoly</code>, <code>dfourier</code>
</td>
<td><code>OpnCoe</code></td>
</tr>
<tr class="odd">
<td>
<code>LdkCoo</code> (configuration of landmarks)</td>
<td>
<code>fgProcrustes</code>, <code>slide</code>
</td>
<td><code>LdkCoe</code></td>
</tr>
</tbody>
</table>
<p>In other words:</p>
<ul>
<li>any collection of shapes belongs to (pick one) <code>{OutCoo, OpnCoo, LdkCoo}</code> and is also a <code>Coo</code> object;</li>
<li>generic and specific methods can be applied to it</li>
<li>a collection of coefficients is obtain and belongs to (pick one) <code>{OutCoe, OpnCoe, LdkCoe}</code> and is also a <code>Coe</code> object.</li>
</ul>
<p>Finally, generic and specific operations can be applied to the <code>Coe</code> objects, chiefly multivariate methods, capitalicized: <code>PCA</code>, <code>LDA</code>, <code>CLUST</code>, <code>MANOVA</code>(and MANCOVA), <code>MSHAPES</code>, <code>KMEANS</code>, etc.</p>
<p>Overall, Momocs implements a simple and consistent grammar that is detailed below. Also, if you’re familiar with modern R and the Hadley-verse, you should feel home as <code>ggplot2</code> graphics, <code>dplyr</code> verbs and <code>magrittr</code> pipes are implemented.</p>
</div>
<div id="single-shapes" class="section level2">
<h2 class="hasAnchor">
<a href="#single-shapes" class="anchor"></a>Single shapes</h2>
<p>Let’s load one of the Momocs datasets, some various outlines (an <code>Out</code> object):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">shapes                    <span class="co"># prints a brief summary</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../reference/panel.Coo.html">panel</a></span>(shapes, <span class="dt">names=</span><span class="ot">TRUE</span>) <span class="co"># base graphics</span></a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code>## Out (outlines)
##   - 30 outlines, 836 +/- 255 coords (in $coo)
##   - 0 classifiers (in $fac): 
## # A tibble: 0 x 0
##   - also: $ldk</code></pre>
<p><code>shapes</code> is one of the datasets bundled with Momocs. It’s (“lazy”) loaded in memory as soon as you call it, no need for <code>data(shapes)</code>. To see all Momocs’ datasets, try <code>data(package="Momocs")</code>. These datasets are all <code>Coo</code> objects (try <code>class(bot)</code>), ie collection of shapes.</p>
<p>One can do many things on a <code>Coo</code> object, as above, eg printing a summary of it (just by typing its name in the console), plotting a family picture with <code>panel</code>, etc.</p>
<p>So far, we’re interested in single shapes so let’s extract the 4th shape from <code>shapes</code>, using the traditional syntax. We plot it with <code>coo_plot</code> that comes with several options for plotting all families of shapes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">shp &lt;-<span class="st"> </span>shapes[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(shp)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># coo_plot is the base plotter for shapes</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># but it can be finely customized, see ?coo_plot</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(shp, <span class="dt">col=</span><span class="st">"grey80"</span>, <span class="dt">border=</span><span class="ot">NA</span>, <span class="dt">centroid=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">"Meow"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>Let’s now do some basic operations on this shape. They all named <code>coo_*</code> and you can have the full list with <code>apropos("coo_")</code>. <code>coo_*</code> family encompasses:</p>
<ul>
<li>geometric operations (such as centering, scaling, etc.)</li>
<li>plotting functions</li>
<li>scalar descriptors of shape (such as area, perimeter, circularity, rectilinearity, etc.)</li>
<li>various other operations on a single shape.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(<span class="kw"><a href="../reference/coo_center.html">coo_center</a></span>(shp), <span class="dt">main=</span><span class="st">"centered Meow"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(<span class="kw"><a href="../reference/coo_sample.html">coo_sample</a></span>(shp, <span class="dv">64</span>), <span class="dt">points=</span><span class="ot">TRUE</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">main=</span><span class="st">"64-pts Meow"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<p>Momocs is fully compatible with <a href="https://CRAN.R-project.org/package=magrittr">maggritr</a>’s pipe operators. A nice introduction can be found <a href="https://CRAN.R-project.org/package=magrittr">there</a>. <code>magrittr</code> requires a (very small) cerebral gymnastics at the beginning but the benefits are huge, for defining moprhometric pipelines in Momocs but also for R as a whole. It makes things clearer, it: saves typing; reduces intermediate variable assignation; reads from left to right; substantiates the pipe we (should) have in mind. <code>magrittr</code>’s pipes are already loaded with Momocs.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">shapes[<span class="dv">4</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_smooth.html">coo_smooth</a></span>(<span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_sample.html">coo_sample</a></span>(<span class="dv">64</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coo_scale</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>()</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># pipes can be turned into custom function</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">cs64 &lt;-<span class="st"> </span><span class="cf">function</span>(x) x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_sample.html">coo_sample</a></span>(<span class="dv">64</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coo_scale</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_center.html">coo_center</a></span>()</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">shapes[<span class="dv">4</span>] <span class="op">%&gt;%</span><span class="st"> </span>cs64 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>() <span class="co"># note the axes</span></a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>Have a look to the dedicated vignette with <code><a href="../articles/Momocs_coo.html">vignette("Momocs_coo")</a></code>.</p>
<p>The most familiar operation can directly be applied on <code>Coo</code> objects:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">bot <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">coo_center <span class="op">%&gt;%</span><span class="st"> </span>coo_scale <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="../reference/coo_alignxax.html">coo_alignxax</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_slidedirection.html">coo_slidedirection</a></span>(<span class="st">"up"</span>) <span class="op">%T&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw">print</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/stack.Coo.html">stack</a></span>()</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code>## Out (outlines)
##   - 40 outlines, 162 +/- 21 coords (in $coo)
##   - 2 classifiers (in $fac): 
## # A tibble: 40 x 2
##   type   fake 
##   &lt;fct&gt;  &lt;fct&gt;
## 1 whisky a    
## 2 whisky a    
## 3 whisky a    
## 4 whisky a    
## 5 whisky a    
## 6 whisky a    
## # ... with 34 more rows
##   - also: $ldk</code></pre>
</div>
<div id="morphometrics" class="section level2">
<h2 class="hasAnchor">
<a href="#morphometrics" class="anchor"></a>Morphometrics</h2>
<div id="outline-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#outline-analysis" class="anchor"></a>Outline analysis</h3>
<p>A word about data import: you can extract outlines from a list of black masks over a white background, as <code>.jpg</code> images with <code>import_jpg</code>. Have a look to helpfiles (<code>import_jpg</code> and <code>import_jpg1</code>) for more details. Here we do not bother with import since we will use the <code>bot</code>tles outlines dataset bundled with Momocs.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">data</span>(bot)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">bot</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw"><a href="../reference/panel.Coo.html">panel</a></span>(bot, <span class="dt">fac=</span><span class="st">"type"</span>, <span class="dt">names=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/stack.Coo.html">stack</a></span>(bot)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<pre><code>## Out (outlines)
##   - 40 outlines, 162 +/- 21 coords (in $coo)
##   - 2 classifiers (in $fac): 
## # A tibble: 40 x 2
##   type   fake 
##   &lt;fct&gt;  &lt;fct&gt;
## 1 whisky a    
## 2 whisky a    
## 3 whisky a    
## 4 whisky a    
## 5 whisky a    
## 6 whisky a    
## # ... with 34 more rows
##   - also: $ldk</code></pre>
<p>Here, we will illustrate outline analysis with elliptical Fourier transforms (but the less used and tested <code>rfourier</code>, <code>sfourier</code> and <code>tfourier</code> are also implemented).</p>
<p>The idea behind elliptical Fourier transforms is to fit the <code>x</code> and <code>y</code> coordinates separately, that is the blue and red curves below:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/coo_oscillo.html">coo_oscillo</a></span>(bot[<span class="dv">1</span>], <span class="st">"efourier"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code>## # A tibble: 138 x 2
##       dx    dy
##    &lt;dbl&gt; &lt;dbl&gt;
##  1     0     0
##  2     3   -21
##  3     3   -32
##  4     6   -53
##  5     9   -74
##  6    11   -84
##  7    15  -105
##  8    17  -126
##  9    20  -147
## 10    22  -158
## # ... with 128 more rows</code></pre>
<p>Graphically, this is equivalent to fitting Ptolemaic ellipses on the plane, try the following:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/Ptolemy.html">Ptolemy</a></span>(bot[<span class="dv">1</span>])</a></code></pre></div>
<p>Let’s calibrate the number of harmonics required. More details can be found in their respective help files. Try the following:</p>
<p>Here, 10 harmonics gather 99% of the harmonic power. If you’re happy with this criterium, you can even omit <code>nb.h</code> in <code>efourier</code>: that’s the default parameter, returned with a message.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">bot.f &lt;-<span class="st"> </span><span class="kw"><a href="../reference/efourier.html">efourier</a></span>(bot, <span class="dt">nb.h=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">bot.f</a></code></pre></div>
<pre><code>## An OutCoe object [ elliptical Fourier analysis ]
## --------------------
##  - $coe: 40 outlines described, 10 harmonics
## # A tibble: 40 x 2
##   type   fake 
##   &lt;fct&gt;  &lt;fct&gt;
## 1 whisky a    
## 2 whisky a    
## 3 whisky a    
## 4 whisky a    
## 5 whisky a    
## 6 whisky a    
## # ... with 34 more rows</code></pre>
<p><code>bot.f</code> is a <code>Coe</code> object (and even an <code>OutCoe</code>), you have have a look to the help files to go deeper into Momocs classes.</p>
<p>You can have a look to the amplitude of fitted coefficients with:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">boxplot</span>(bot.f, <span class="dt">drop=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Now, we can calculate a PCA on the <code>Coe</code> object and plot it, along with morphospaces, calculated on the fly.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">bot.p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>(bot.f)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">class</span>(bot.p)        <span class="co"># a PCA object, let's plot it</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw">plot</span>(bot.p)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<pre><code>## [1] "PCA"    "prcomp"</code></pre>
<p>Amazing but we will do much better afterwards.</p>
<p>The question of normalization in elliptical Fourier transforms is central: have a look to <code><a href="../reference/efourier.html">?efourier</a></code>.</p>
<p>You can also drop some harmonics with <code>rm_harm</code>. And methods that removes the bilateral (a)symmetry are implemented: <code>rm_asym</code> and <code>rm_sym</code>, while <code>symmetry</code> calculates some related indices.</p>
</div>
<div id="open-outlines" class="section level3">
<h3 class="hasAnchor">
<a href="#open-outlines" class="anchor"></a>Open outlines</h3>
<p>Open outlines are curves. Methods actually implemented are:</p>
<ul>
<li>
<code>npoly</code> that fit natural polynomials;</li>
<li>
<code>opoly</code> that fit orthogonal (also called Legendre’s) polynomials;</li>
<li>
<code>dfourier</code> for the discrete cosine transform.</li>
</ul>
<p>Note that <code>opoly</code> and <code>npoly</code> can only be used on <em>simple</em> curves, curves that have at most one <code>y</code> for any <code>x</code> coordinates, at least under a given orientation. <code>dfourier</code> can fit <em>complex</em> curves, curves “that back on their feets”.</p>
<p>Here, we will work on the fertile valves of olive stones, a (very partial) dataset provided by my colleagues Terral, Ivorra, and others.</p>
<p>They have two orthogonal views (a lateral and a dorsal view). See the paper cited in <code><a href="../reference/data_olea.html">?olea</a></code> for more details. Let’s explore it a bit:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">olea</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="../reference/pile.html">pile</a></span>(olea, <span class="op">~</span>view)    <span class="co"># a family picture colored by a factor</span></a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<pre><code>## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 210 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VL    O10  
## 3 Aglan cult  VD    O11  
## 4 Aglan cult  VL    O11  
## 5 Aglan cult  VD    O12  
## 6 Aglan cult  VL    O12  
## # ... with 204 more rows
##   - also: $ldk</code></pre>
<p>Now, we gonna calculate <code>opoly</code> on it and plot the result of the PCA. Notice how consistent is the grammar and the objects obtained:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">op &lt;-<span class="st"> </span><span class="kw"><a href="../reference/opoly.html">opoly</a></span>(olea)           <span class="co"># orthogonal polynomials</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">class</span>(op)                   <span class="co"># an OpnCoe, but also a Coe</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">op.p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>(op)             <span class="co"># we calculate a PCA on it</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="kw">class</span>(op.p)                 <span class="co"># a PCA object</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">op <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot</span>(<span class="op">~</span>domes<span class="op">+</span>var)   <span class="co"># notice the formula interface to combine factors</span></a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<pre><code>## [1] "OpnCoe" "Coe"   
## [1] "PCA"    "prcomp"</code></pre>
<p>But this is perfectly wrong! We merged the two views are if they were different individuals. Momocs can first <code>chop</code> or <code>filter</code> the whole dataset to separate the two views, do morphometrics on them, and <code>combine</code> them afterwards.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">with</span>(olea<span class="op">$</span>fac, <span class="kw">table</span>(view, var))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co"># we drop 'Cypre' since there is no VL for 'Cypre' var</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3">olea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/filter.html">filter</a></span>(var <span class="op">!=</span><span class="st"> "Cypre"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co"># split, do morphometrics, combine</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="kw"><a href="../reference/chop.html">chop</a></span>(<span class="op">~</span>view) <span class="op">%&gt;%</span><span class="st"> </span>opoly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/combine.html">combine</a></span>() <span class="op">%T&gt;%</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co"># we print the OpnCoe object, then resume to the pipe</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="kw">print</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co"># note the two views in the morphospace</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>var)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<pre><code>##     var
## view Aglan Cypre MouBo1 PicMa
##   VD    30    30     30    30
##   VL    30     0     30    30
## An OpnCoe object [ combined: opoly + opoly analyses ]
## --------------------
##  - $coe: 90 open outlines described
##  - $baseline1: (-0.5; 0; -0.5; 0)
##  - $baseline2: (0.5; 0; 0.5; 0)
## # A tibble: 90 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VD    O11  
## 3 Aglan cult  VD    O12  
## 4 Aglan cult  VD    O13  
## 5 Aglan cult  VD    O14  
## 6 Aglan cult  VD    O15  
## # ... with 84 more rows</code></pre>
<p>Now the PCA is done on the combination of two <code>OpnCoe</code> objects, each one resulting from an independant <code>opoly</code> call. That is the meaning of the <code>[ combined: opoly + opoly analyses ]</code> printed by the pipe above. Momocs can combine up to four different views.</p>
</div>
<div id="configuration-of-landmarks" class="section level3">
<h3 class="hasAnchor">
<a href="#configuration-of-landmarks" class="anchor"></a>Configuration of landmarks</h3>
<p>_Landmarks methods are still quite experimental (i.e. not tested extensively)</p>
<p>Let’s have a look to graphics facilities and apply a full generalized Procrustes adjustment:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="../reference/pile.html">pile</a></span>(wings)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">Momocs_verbose=</span><span class="ot">FALSE</span>) <span class="co"># to silent Momocs</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">w.al &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fgProcrustes.html">fgProcrustes</a></span>(wings)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw"><a href="../reference/pile.html">pile</a></span>(w.al)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-21-2.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># PCA</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw"><a href="../reference/PCA.html">PCA</a></span>(w.al) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="dv">1</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-21-3.png" width="700"></p>
<p>Sliding landmarks are supported and rely on <code>geomorph</code> package by Adams and colleagues.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="../reference/pile.html">pile</a></span>(chaff)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">chaff.al &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fgsProcrustes.html">fgsProcrustes</a></span>(chaff)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw"><a href="../reference/pile.html">pile</a></span>(chaff.al)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-22-2.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">chaff.al <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>taxa, <span class="dt">chullfilled =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-22-3.png" width="700"></p>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |=================================================================| 100%</code></pre>
<p>Again, the grammar is consistent for landmarks.</p>
</div>
<div id="traditional-morphometrics" class="section level3">
<h3 class="hasAnchor">
<a href="#traditional-morphometrics" class="anchor"></a>Traditional morphometrics</h3>
<p>Traditional morphometrics lose geometries: from the variables, you can’t unambiguously reconstruct the shape. Every shape is described by a combination of measurements, (inter landmark distance, quantitative variables, scalar descriptor, etc.)</p>
<p>Momocs provides some basics utilities to work with such objects in the <code>TraCoe</code> class. There is not <code>TraCoo</code> per se but it can be obtained from any <code>Coo</code> with the <code>measure</code> method. Let’s take the <code>hearts</code> dataset that comes from handdrawn heart shapes from my former colleagues at the French Intitute of Pondicherry:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">hearts</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw"><a href="../reference/panel.Coo.html">panel</a></span>(hearts, <span class="dt">fac=</span><span class="st">"aut"</span>, <span class="dt">names=</span><span class="st">"aut"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<pre><code>## Out (outlines)
##   - 240 outlines, 80 +/- 0 coords (in $coo)
##   - 1 classifiers (in $fac): 
## # A tibble: 240 x 1
##   aut  
##   &lt;fct&gt;
## 1 ced  
## 2 ced  
## 3 ced  
## 4 ced  
## 5 ced  
## 6 ced  
## # ... with 234 more rows
##   - also: $ldk</code></pre>
<p>Notice that there are 4 landmarks defined on them. Such landmarks on outlines can be: defined with<code><a href="../reference/def_ldk.html">def_ldk()</a></code>, retrieved with <code><a href="../reference/get_ldk.html">get_ldk()</a></code>, and overall used to align outlines with <code><a href="../reference/fgProcrustes.html">fgProcrustes()</a></code>. You can compare: <code>hearts %&gt;% stack()</code> with <code>hearts %&gt;% fgProcrustes() %&gt;% coo_slide(ldk=1) %&gt;% stack()</code>.</p>
<p>Let’s describe these hearts with scalar descriptors: area, circularity and the distance between the 1st and the 3rd bumps of the hearts. <code>measure</code> is of great help. Note the loadings.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">ht &lt;-<span class="st"> </span><span class="kw"><a href="../reference/measure.html">measure</a></span>(hearts, coo_area, coo_circularity, <span class="kw"><a href="../reference/d.html">d</a></span>(<span class="dv">1</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">class</span>(ht)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">ht<span class="op">$</span>coe</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">ht <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>aut)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<pre><code>## [1] "TraCoe" "Coe"   
## # A tibble: 240 x 3
##     area circularity   d1.3
##  * &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
##  1 0.627        14.0 0.0695
##  2 0.593        14.5 0.0639
##  3 0.611        16.1 0.0699
##  4 0.539        15.7 0.0627
##  5 0.541        13.6 0.0613
##  6 0.611        16.0 0.0692
##  7 0.617        16.5 0.0755
##  8 0.535        15.8 0.0655
##  9 0.521        14.3 0.0622
## 10 0.546        15.2 0.0642
## # ... with 230 more rows</code></pre>
<p>Again, there are plenty of scalar descriptors of shape, which names starts with <code>coo_*</code>, <code>apropos("coo_")</code>. Have a look to the coo_vignette, see <code><a href="../articles/Momocs_coo.html">vignette("Momocs_coo")</a></code>.</p>
<p>Such a <code>TraCoe</code> is provided in the <code>flower</code> dataset which is simply a rearranged <code>iris</code>. Once again, note the grammar consistency.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">flower</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">flower <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>sps)</a></code></pre></div>
<p>You can build your own <code>TraCoe</code> with <code>coo_scalars</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">bot_sc &lt;-<span class="st"> </span>bot <span class="op">%&gt;%</span><span class="st"> </span>coo_scalars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/TraCoe.html">TraCoe</a></span>(<span class="dt">fac=</span>bot<span class="op">$</span>fac)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">bot_sc <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>type)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Note that, by default, PCA on <code>TraCoe</code> object first centers and scales variables. This can be changed, see <code><a href="../reference/PCA.html">?PCA</a></code>.</p>
</div>
</div>
<div id="multivariate-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#multivariate-statistics" class="anchor"></a>Multivariate statistics</h2>
<p>This section will mainly be illustrated with <code>bot</code>, and consequently outline analysis, but it works exactly the same on any <code>Coe</code> object, resulting from open outlines, configuration of landmarks, traditional morphometrics, etc.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">bot.f &lt;-<span class="st"> </span><span class="kw"><a href="../reference/efourier.html">efourier</a></span>(bot)</a></code></pre></div>
<div id="pca-principal-component-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#pca-principal-component-analysis" class="anchor"></a><code>PCA</code>: Principal Component Analysis</h3>
<p>Let’s see the main components of shape variability with a Principal Component Analysis.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">bot.p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>(bot.f)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(bot.p)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>Morphological spaces are reconstructed on the fly with <code>plot.PCA</code>. We call it <code>plot.PCA</code> because it uses the familiar <code>plot</code> but on the particular <code>PCA</code> class (type <code>class(bot.p)</code>). We may want to display the two groups saved in <code>bot$fac</code>. Just type the id of the column or its name.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(bot.p, <span class="op">~</span>type) <span class="co"># there are many ways to pass the factor, see ?plot_PCA and ?fac_dispatcher</span></a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>See <code><a href="../reference/plot_PCA.html">?plot_PCA</a></code> for much more complex graphics. And also these helper functions for the <code>PCA</code> class:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw"><a href="../reference/scree.html">scree</a></span>(bot.p)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw"><a href="../reference/scree.html">scree_plot</a></span>(bot.p)</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="kw">boxplot</span>(bot.p, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="kw"><a href="../reference/PCcontrib.html">PCcontrib</a></span>(bot.p)</a></code></pre></div>
<p>You can also export the <code>PCA</code> object as a <code>.txt</code> file (see <code><a href="../reference/export.html">?export</a></code>) or as a <code>data_frame</code> for further use with R with:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">bot.p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/as_df.html">as_df</a></span>(<span class="dv">3</span>) <span class="co"># The first three PCs </span></a></code></pre></div>
<pre><code>## # A tibble: 40 x 5
##    type   fake      PC1       PC2      PC3
##    &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 whisky a     -0.0528 -0.0231    0.00245
##  2 whisky a     -0.0369  0.00725  -0.00866
##  3 whisky a      0.0809 -0.00479  -0.00222
##  4 whisky a     -0.0694  0.00229  -0.0158 
##  5 whisky a     -0.0112  0.0476   -0.0127 
##  6 whisky a      0.115  -0.0170   -0.0103 
##  7 whisky a     -0.0443 -0.0186   -0.00496
##  8 whisky a      0.0287  0.00996  -0.0114 
##  9 whisky a      0.0123  0.000603  0.00364
## 10 whisky a     -0.0458  0.00564  -0.00889
## # ... with 30 more rows</code></pre>
<p>By the way, you can use Momocs plotters to plot non-morphometric datasets. Using a <code>TraCoe</code> object is an option, but <code>PCA</code> also works fine. Let’s see an example with <code>iris</code> dataset:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="../reference/TraCoe.html">TraCoe</a></span>(iris[, <span class="dv">-5</span>], <span class="dt">fac=</span><span class="kw">data.frame</span>(<span class="dt">sp=</span>iris<span class="op">$</span>Species)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>sp)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
<div id="lda-linear-discriminant-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#lda-linear-discriminant-analysis" class="anchor"></a><code>LDA</code>: Linear Discriminant Analysis</h3>
<p>We can also calculate a Linear Discriminant Analysis on the PCA scores, or on the <code>Coe</code> object, directly on the matrix of coefficients (and results may be better yet we may encounter collinearity between variables). Try the following:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co">#LDA(bot.f, 1)</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="co"># we work on PCA scores</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">bot.l &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LDA.html">LDA</a></span>(bot.p, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="co"># print a summary, along with the leave-one-out cross-validation table.</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5">bot.l</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co"># a much more detailed summary</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">bot.l <span class="op">%&gt;%</span><span class="st"> </span>summary</a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="co"># plot.LDA works pretty much with the same grammar as plot.PCA</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="co"># here we only have one LD</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="kw">plot</span>(bot.l)</a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="co"># plot the cross-validation table</span></a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="kw"><a href="../reference/plot_CV.html">plot_CV</a></span>(bot.l)  <span class="co"># tabular version</span></a></code></pre></div>
<p>You can also export turn it into a <code>data_frame</code> with <code>as_df</code>.</p>
</div>
<div id="manova-multivariate-analysis-of-covariace" class="section level3">
<h3 class="hasAnchor">
<a href="#manova-multivariate-analysis-of-covariace" class="anchor"></a><code>MANOVA</code>: Multivariate Analysis of (co)variace</h3>
<p>We can test for a difference in the distribution of PC scores with:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw"><a href="../reference/MANOVA.html">MANOVA</a></span>(bot.p,  <span class="op">~</span>type)</a></code></pre></div>
<pre><code>##           Df Hotelling-Lawley approx F num Df den Df   Pr(&gt;F)    
## fac        1           2.8388   12.977      7     32 8.88e-08 ***
## Residuals 38                                                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>We can also calculate pairwise combination between every levels of a <code>fac</code>. Here we just have two levels, so a single pairwise combination but the syntax is:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw"><a href="../reference/MANOVA_PW.html">MANOVA_PW</a></span>(bot.p, <span class="op">~</span>type)</a></code></pre></div>
<pre><code>## $stars.tab
##      beer whisky
## beer      ***   
## 
## $summary (see also $manovas)
##               Df Pillai approx F num Df den Df   Pr(&gt;F)
## beer - whisky  1 0.7395    12.98      7     32 8.88e-08</code></pre>
<p>If we want a MANCOVA instead :</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">bot <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/mutate.html">mutate</a></span>(<span class="dt">cs=</span><span class="kw"><a href="../reference/coo_centsize.html">coo_centsize</a></span>(.))</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">bot <span class="op">%&gt;%</span><span class="st"> </span>efourier <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/MANOVA.html">MANOVA</a></span>(<span class="op">~</span>cs)</a></code></pre></div>
<pre><code>##           Df Hotelling-Lawley approx F num Df den Df Pr(&gt;F)
## fac        1          0.32229   1.4733      7     32  0.212
## Residuals 38</code></pre>
</div>
<div id="clust-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#clust-hierarchical-clustering" class="anchor"></a><code>CLUST</code>: Hierarchical clustering</h3>
<p>A hierarchical classification now. It relies on <code>dist</code> + <code>hclust</code> + <code><a href="http://www.rdocumentation.org/packages/ape/topics/plot.phylo">ape::plot.phylo</a></code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw"><a href="../reference/CLUST.html">CLUST</a></span>(bot.p, <span class="op">~</span>type)</a></code></pre></div>
<p>Monophyly is plotted by default. Many options can be found in <code><a href="../reference/CLUST.html">?CLUST</a></code></p>
</div>
<div id="kmeans-k-means-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#kmeans-k-means-clustering" class="anchor"></a><code>KMEANS</code>: K-means clustering</h3>
<p>A very minimal k-means clustering is implemented:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw"><a href="../reference/KMEANS.html">KMEANS</a></span>(bot.p, <span class="dt">centers =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<pre><code>## K-means clustering with 5 clusters of sizes 5, 5, 6, 18, 6
## 
## Cluster means:
##           PC1          PC2
## 1  0.06730453  0.050371247
## 2  0.02497106 -0.006671549
## 3 -0.02673158  0.017713990
## 4 -0.05066899 -0.008418168
## 5  0.10184224 -0.028875902
## 
## Clustering vector:
##         brahma          caney         chimay         corona    deusventrue 
##              4              3              5              4              3 
##          duvel   franziskaner     grimbergen        guiness     hoegardeen 
##              5              4              2              2              4 
##        jupiler     kingfisher       latrappe lindemanskriek    nicechouffe 
##              4              4              5              3              3 
##     pecheresse   sierranevada     tanglefoot          tauro      westmalle 
##              4              2              5              4              4 
##          amrut    ballantines      bushmills         chivas        dalmore 
##              4              5              4              1              1 
##   famousgrouse    glendronach   glenmorangie   highlandpark    jackdaniels 
##              4              4              4              5              2 
##             jb  johnniewalker       magallan     makersmark           oban 
##              3              4              4              1              4 
##     oldpotrero      redbreast         tamdhu     wildturkey         yoichi 
##              1              1              4              3              2 
## 
## Within cluster sum of squares by cluster:
## [1] 0.002720829 0.001916822 0.001886406 0.007905382 0.006121728
##  (between_SS / total_SS =  88.6 %)
## 
## Available components:
## 
## [1] "cluster"      "centers"      "totss"        "withinss"    
## [5] "tot.withinss" "betweenss"    "size"         "iter"        
## [9] "ifault"</code></pre>
</div>
<div id="mshapes-mean-shapes" class="section level3">
<h3 class="hasAnchor">
<a href="#mshapes-mean-shapes" class="anchor"></a><code>MSHAPES</code>: Mean shapes</h3>
<p>We can retrieve the mean shapes, group wise (if a <code>fac</code> is specified), or the global mean shape (if omitted). It works from the <code>Coe</code> object:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="co"># mean shape</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2">bot.f <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/MSHAPES.html">MSHAPES</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>()</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co"># mean shape, per group</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">bot.ms &lt;-<span class="st"> </span><span class="kw"><a href="../reference/MSHAPES.html">MSHAPES</a></span>(bot.f, <span class="op">~</span>type)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="co"># lets rebuild an Out</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="kw"><a href="../reference/Out.html">Out</a></span>(bot.ms<span class="op">$</span>shp) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/panel.Coo.html">panel</a></span>(<span class="dt">names=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-39-2.png" width="700"></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="co"># or individual shapes</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2">beer   &lt;-<span class="st"> </span>bot.ms<span class="op">$</span>shp<span class="op">$</span>beer    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(<span class="dt">border=</span><span class="st">"blue"</span>)</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">whisky &lt;-<span class="st"> </span>bot.ms<span class="op">$</span>shp<span class="op">$</span>whisky  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/coo_draw.html">coo_draw</a></span>(<span class="dt">border=</span><span class="st">"red"</span>)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-39-3.png" width="700"></p>
<p>We can also plot a pairwise comparison of them:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">leaves &lt;-<span class="st"> </span>shapes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/slice.html">slice</a></span>(<span class="kw">grep</span>(<span class="st">"leaf"</span>, <span class="kw">names</span>(shapes))) <span class="op">%$%</span><span class="st"> </span>coo</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">leaves <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_MSHAPES.html">plot_MSHAPES</a></span>()</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co"># or from mshapes directly</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2">bot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/efourier.html">efourier</a></span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/MSHAPES.html">MSHAPES</a></span>(<span class="op">~</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_MSHAPES.html">plot_MSHAPES</a></span>()</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-40-2.png" width="700"></p>
</div>
</div>
<div id="manipulating-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#manipulating-objects" class="anchor"></a>Manipulating objects</h2>
<p>One common yet boring task of morphometrics consists in handling datasets: add new information, remove some individuals, etc.</p>
<p>Momocs adapts <a href="https://CRAN.R-project.org/package=dplyr">dplyr</a> verbs to its objects, and add new ones. If you have never heard of dplyr, let’s have a look to its introduction <a href="https://CRAN.R-project.org/package=dplyr">there</a>, this may change your (R) life.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">data</span>(olea)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">olea</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 210 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VL    O10  
## 3 Aglan cult  VD    O11  
## 4 Aglan cult  VL    O11  
## 5 Aglan cult  VD    O12  
## 6 Aglan cult  VL    O12  
## # ... with 204 more rows
##   - also: $ldk</code></pre>
<div id="mutate-add-new-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#mutate-add-new-columns" class="anchor"></a><code>mutate</code>: add new columns</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw"><a href="../reference/mutate.html">mutate</a></span>(olea, <span class="dt">fake=</span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">each=</span><span class="dv">105</span>)))</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 5 classifiers (in $fac): 
## # A tibble: 210 x 5
##   var   domes view  ind   fake 
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10   a    
## 2 Aglan cult  VL    O10   a    
## 3 Aglan cult  VD    O11   a    
## 4 Aglan cult  VL    O11   a    
## 5 Aglan cult  VD    O12   a    
## 6 Aglan cult  VL    O12   a    
## # ... with 204 more rows
##   - also: $ldk</code></pre>
</div>
<div id="slice-select-individuals-based-on-their-position" class="section level3">
<h3 class="hasAnchor">
<a href="#slice-select-individuals-based-on-their-position" class="anchor"></a><code>slice</code>: select individuals based on their position</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw"><a href="../reference/slice.html">slice</a></span>(olea, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 5 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 5 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VL    O10  
## 3 Aglan cult  VD    O11  
## 4 Aglan cult  VL    O11  
## 5 Aglan cult  VD    O12  
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw"><a href="../reference/slice.html">slice</a></span>(olea, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>))</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 110 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 110 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 PicMa cult  VD    O15  
## 2 PicMa cult  VL    O15  
## 3 PicMa cult  VD    O16  
## 4 PicMa cult  VL    O16  
## 5 PicMa cult  VD    O17  
## 6 PicMa cult  VL    O17  
## # ... with 104 more rows
##   - also: $ldk</code></pre>
</div>
<div id="filter-select-individual-based-on-a-logical-condition" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-select-individual-based-on-a-logical-condition" class="anchor"></a><code>filter</code>: select individual based on a logical condition</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw"><a href="../reference/filter.html">filter</a></span>(olea, domes<span class="op">==</span><span class="st">"cult"</span>)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 150 curves, 99 +/- 3 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 150 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VL    O10  
## 3 Aglan cult  VD    O11  
## 4 Aglan cult  VL    O11  
## 5 Aglan cult  VD    O12  
## 6 Aglan cult  VL    O12  
## # ... with 144 more rows
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="co"># %in% is useful</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw"><a href="../reference/filter.html">filter</a></span>(olea, var <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Aglan"</span>, <span class="st">"Cypre"</span>))</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 90 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 90 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD    O10  
## 2 Aglan cult  VL    O10  
## 3 Aglan cult  VD    O11  
## 4 Aglan cult  VL    O11  
## 5 Aglan cult  VD    O12  
## 6 Aglan cult  VL    O12  
## # ... with 84 more rows
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># or its complement</span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="kw"><a href="../reference/filter.html">filter</a></span>(olea, <span class="op">!</span>(var <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Aglan"</span>, <span class="st">"Cypre"</span>)))</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 120 curves, 99 +/- 3 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 120 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 PicMa cult  VD    O10  
## 2 PicMa cult  VL    O10  
## 3 PicMa cult  VD    O11  
## 4 PicMa cult  VL    O11  
## 5 PicMa cult  VD    O12  
## 6 PicMa cult  VL    O12  
## # ... with 114 more rows
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="co"># Also works with more than one condition</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw"><a href="../reference/filter.html">filter</a></span>(olea, domes<span class="op">==</span><span class="st">"cult"</span>, view<span class="op">!=</span><span class="st">"VD"</span>)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 60 curves, 97 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 60 x 4
##   var   domes view  ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VL    O10  
## 2 Aglan cult  VL    O11  
## 3 Aglan cult  VL    O12  
## 4 Aglan cult  VL    O13  
## 5 Aglan cult  VL    O14  
## 6 Aglan cult  VL    O15  
## # ... with 54 more rows
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="co"># or on operation on numeric, here a dummy numeric column</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2">olea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/mutate.html">mutate</a></span>(<span class="dt">foo=</span><span class="dv">1</span><span class="op">:</span><span class="dv">210</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/filter.html">filter</a></span>(foo<span class="op">&lt;</span><span class="dv">12</span>)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 11 curves, 99 +/- 5 coords (in $coo)
##   - 5 classifiers (in $fac): 
## # A tibble: 11 x 5
##   var   domes view  ind     foo
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt;
## 1 Aglan cult  VD    O10       1
## 2 Aglan cult  VL    O10       2
## 3 Aglan cult  VD    O11       3
## 4 Aglan cult  VL    O11       4
## 5 Aglan cult  VD    O12       5
## 6 Aglan cult  VL    O12       6
## # ... with 5 more rows
##   - also: $ldk</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">olea <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/mutate.html">mutate</a></span>(<span class="dt">foo=</span><span class="dv">1</span><span class="op">:</span><span class="dv">210</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/filter.html">filter</a></span>(foo<span class="op">&gt;</span><span class="kw">median</span>(foo))</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 105 curves, 99 +/- 4 coords (in $coo)
##   - 5 classifiers (in $fac): 
## # A tibble: 105 x 5
##   var   domes view  ind     foo
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt;
## 1 PicMa cult  VL    O17     106
## 2 PicMa cult  VD    O18     107
## 3 PicMa cult  VL    O18     108
## 4 PicMa cult  VD    O19     109
## 5 PicMa cult  VL    O19     110
## 6 PicMa cult  VD    O1      111
## # ... with 99 more rows
##   - also: $ldk</code></pre>
</div>
<div id="select-pick-reorder-columns-from-the-fac" class="section level3">
<h3 class="hasAnchor">
<a href="#select-pick-reorder-columns-from-the-fac" class="anchor"></a><code>select</code>: pick, reorder columns from the $fac</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="co"># reorder columns</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw"><a href="../reference/select.html">select</a></span>(olea, view, domes, var, ind)</a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="co"># drop some and show the use of numeric index</span></a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="kw"><a href="../reference/select.html">select</a></span>(olea, <span class="dv">1</span>, <span class="dt">Ind=</span>ind)</a>
<a class="sourceLine" id="cb87-5" data-line-number="5"><span class="co"># drop one</span></a>
<a class="sourceLine" id="cb87-6" data-line-number="6"><span class="kw"><a href="../reference/select.html">select</a></span>(olea, <span class="op">-</span>ind)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 4 classifiers (in $fac): 
## # A tibble: 210 x 4
##   view  domes var   ind  
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 VD    cult  Aglan O10  
## 2 VL    cult  Aglan O10  
## 3 VD    cult  Aglan O11  
## 4 VL    cult  Aglan O11  
## 5 VD    cult  Aglan O12  
## 6 VL    cult  Aglan O12  
## # ... with 204 more rows
##   - also: $ldk
## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 2 classifiers (in $fac): 
## # A tibble: 210 x 2
##   var   Ind  
##   &lt;fct&gt; &lt;fct&gt;
## 1 Aglan O10  
## 2 Aglan O10  
## 3 Aglan O11  
## 4 Aglan O11  
## 5 Aglan O12  
## 6 Aglan O12  
## # ... with 204 more rows
##   - also: $ldk
## Opn (curves)
##   - 210 curves, 99 +/- 4 coords (in $coo)
##   - 3 classifiers (in $fac): 
## # A tibble: 210 x 3
##   var   domes view 
##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
## 1 Aglan cult  VD   
## 2 Aglan cult  VL   
## 3 Aglan cult  VD   
## 4 Aglan cult  VL   
## 5 Aglan cult  VD   
## 6 Aglan cult  VL   
## # ... with 204 more rows
##   - also: $ldk</code></pre>
<p>And you can pipe those operations: say, we only want dorsal views from domesticated individuals, for a (renamed) ‘status’ column, and drop the ‘ind’ column:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">olea <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw"><a href="../reference/filter.html">filter</a></span>(domes<span class="op">==</span><span class="st">"cult"</span>, view<span class="op">==</span><span class="st">"VD"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="kw"><a href="../reference/rename.html">rename</a></span>(<span class="dt">domesticated=</span>domes) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="kw"><a href="../reference/select.html">select</a></span>(<span class="op">-</span>ind)</a></code></pre></div>
<pre><code>## Opn (curves)
##   - 90 curves, 100 +/- 2 coords (in $coo)
##   - 3 classifiers (in $fac): 
## # A tibble: 90 x 3
##   var   domesticated view 
##   &lt;fct&gt; &lt;fct&gt;        &lt;fct&gt;
## 1 Aglan cult         VD   
## 2 Aglan cult         VD   
## 3 Aglan cult         VD   
## 4 Aglan cult         VD   
## 5 Aglan cult         VD   
## 6 Aglan cult         VD   
## # ... with 84 more rows
##   - also: $ldk</code></pre>
<p>You can also use dplyr verbs on the <code>fac</code> directly, eg:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">olea<span class="op">$</span>fac <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(var) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">n=</span><span class="dv">1</span><span class="op">:</span><span class="kw">n</span>(), <span class="dt">N=</span><span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 210 x 6
## # Groups:   var [4]
##    var   domes view  ind       n     N
##    &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt;
##  1 Aglan cult  VD    O10       1    60
##  2 Aglan cult  VL    O10       2    60
##  3 Aglan cult  VD    O11       3    60
##  4 Aglan cult  VL    O11       4    60
##  5 Aglan cult  VD    O12       5    60
##  6 Aglan cult  VL    O12       6    60
##  7 Aglan cult  VD    O13       7    60
##  8 Aglan cult  VL    O13       8    60
##  9 Aglan cult  VD    O14       9    60
## 10 Aglan cult  VL    O14      10    60
## # ... with 200 more rows</code></pre>
<p>If you want to save it, do not forget to reassign it back to the <code>$fac</code>: <code>olea$fac &lt;- olea$fac %&gt;% some_operations</code> or even <code>olea$fac %&lt;&gt;% some_operations</code>.</p>
<p>Note that if you due to namespace conflicts, if you use <code>dplyr</code>, and in a larger extent the tidyverse you <strong>must</strong> use <code>library(dplyr)</code> (or <code>library(tydyverse)</code>) <strong>before</strong> <code>library(Momocs)</code>.</p>
<p>That being said, the adaptation of these dplyr verbs should save time and some headaches.</p>
<p>New verbs are implemented: for instance, you can <code>chop</code> (a <code>split</code> on <code>Coo</code> objects) according to a condition: this will create a list, on which you can apply further operations, then <code>combine</code> it back. This is particularly useful when you want to apply independant treatments to different partitions, eg orthogonal views of your model. Prior to this, we can use <code>table</code> to cross-tabulate data from <code>$fac</code>. We could have done the first step of what follows with <code>rm_uncomplete</code> that drops (if any) missing data.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">with</span>(olea<span class="op">$</span>fac, <span class="kw">table</span>(var, view))</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co"># we drop 'Cypre' since there is no VL for 'Cypre' var</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">olea <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/filter.html">filter</a></span>(var <span class="op">!=</span><span class="st"> "Cypre"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="st">  </span><span class="co"># split, do morphometrics, combine</span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/chop.html">chop</a></span>(<span class="op">~</span>view) <span class="op">%&gt;%</span><span class="st"> </span>opoly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/combine.html">combine</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="st">  </span><span class="co"># note the two views in the morphospace</span></a>
<a class="sourceLine" id="cb93-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="../reference/PCA.html">PCA</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/plot_PCA.html">plot_PCA</a></span>(<span class="op">~</span>var)</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
<pre><code>##         view
## var      VD VL
##   Aglan  30 30
##   Cypre  30  0
##   MouBo1 30 30
##   PicMa  30 30</code></pre>
</div>
<div id="various-helpers" class="section level3">
<h3 class="hasAnchor">
<a href="#various-helpers" class="anchor"></a>Various helpers</h3>
<p>Some methods help, on <code>Coe</code> objects to: * select groups with at least a certain number of individuals in them: <code>at_least</code> * removes outliers : <code>which_out</code> * sample a given number: <code>sample_n</code>; * sample a given proportion: <code>sample_frac</code>; * generate new individuals based on calibrated Gaussian coefficient generation: <code>breed</code>; * generate new individuals based on permutations: <code>perm</code>.</p>
<p>Several shortcuts are implemented on <code>Coo</code> and <code>Coe</code> objects: * <code>names</code> returns shape names; * <code>length</code> returns their number; * <code>Ntable</code> does the same job and plots a confusion matrix; * <code>[]</code> extracts one (or more) shape; * <code>$</code> can access either a shape name or a column name for the <code>$fac</code>.</p>
<p>Try the following:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="kw">names</span>(bot)</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="kw">length</span>(bot)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3">bot[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb95-4" data-line-number="4">bot[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb95-5" data-line-number="5">bot<span class="op">$</span>brahma</a>
<a class="sourceLine" id="cb95-6" data-line-number="6">bot<span class="op">$</span>type</a></code></pre></div>
</div>
</div>
<div id="babel-importexport" class="section level2">
<h2 class="hasAnchor">
<a href="#babel-importexport" class="anchor"></a>Babel import/export</h2>
<p>There are various morphometrics formats in the wild, almost as much as softwares. Momocs tries to create bridges between them, all gathered in the <strong>Babel</strong> family.</p>
<p>Note that these will move to <a href="https://momx.github.io/Momit/"><strong>Momit</strong></a>/<a href="https://momx.github.io/Momecs/"><strong>Momecs</strong></a> asap.</p>
<div id="bridges-within-r" class="section level3">
<h3 class="hasAnchor">
<a href="#bridges-within-r" class="anchor"></a>Bridges within R</h3>
<p>You can convert from/to array, matrix, list or data.frame with the functions <code>{a, m, l, d}2{a, m, l, d}</code>. For instance, <code>l2a</code> converts a list into an array that you can use with <code>geomorph</code>; <code>a2l</code> does the inverse operation.</p>
<p>Imagine you want to import pupfish from <code>geomorph</code> as a <code>Ldk</code> object:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">library</span>(geomorph)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="kw">data</span>(pupfish)</a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="kw">str</span>(pupfish)</a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="co"># so $coords will become $coo, and</span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="co"># all other components will be turned into a data.frame to feed $fac</span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6"><span class="co"># with a single line</span></a>
<a class="sourceLine" id="cb96-7" data-line-number="7"><span class="kw"><a href="../reference/Ldk.html">Ldk</a></span>(<span class="dt">coo=</span>pupfish<span class="op">$</span>coords <span class="op">%&gt;%</span><span class="st"> </span>a2l,</a>
<a class="sourceLine" id="cb96-8" data-line-number="8">  <span class="dt">fac=</span>pupfish[<span class="op">-</span><span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>())</a></code></pre></div>
</div>
<div id="import-from-stereomorph" class="section level3">
<h3 class="hasAnchor">
<a href="#import-from-stereomorph" class="anchor"></a>Import from StereoMorph</h3>
<p>If you use StereoMorph to digitize landmarks and curves, you can import them, from the files produced with the functions <code>import_StereoMorph_ldk</code> and <code>import_StereoMorph_curve</code>.</p>
</div>
<div id="import-from-tps-and-other-digitizing-softwares" class="section level3">
<h3 class="hasAnchor">
<a href="#import-from-tps-and-other-digitizing-softwares" class="anchor"></a>Import from tps and other digitizing softwares</h3>
<ul>
<li>
<code>.tps</code> files can be read with <code>import_tps</code>
</li>
<li>
<code>.nts</code> files an be read with <code>nts2Coo</code> (will be turned into <code>import_nts</code> soon)</li>
</ul>
</div>
<div id="direct-build-of-coe-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#direct-build-of-coe-objects" class="anchor"></a>Direct build of *Coe objects</h3>
<p>You’re not bound with Momocs from the “shapes” step, ie you do not have to start from <code>Coo</code> objects. For instance if you have a matrix of coefficients, you can directly build an <code>OutCoe</code> with the builder (see below). Same approach for <code>OpnCoe</code> and <code>TraCoe</code>; have a look to the help files of these builders.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># we simulate an imported matrix of coordinates, eg from a .csv</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2">coeffs_from_the_wild &lt;-<span class="st"> </span>bot <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/efourier.html">efourier</a></span>(<span class="dv">6</span>) <span class="op">%$%</span><span class="st"> </span>coe</a>
<a class="sourceLine" id="cb97-3" data-line-number="3">coeffs_in_Momocs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/OutCoe.html">OutCoe</a></span>(<span class="dt">coe=</span>coeffs_from_the_wild, <span class="dt">method=</span><span class="st">"efourier"</span>, <span class="dt">norm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb97-4" data-line-number="4">coeffs_in_Momocs <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span>plot</a></code></pre></div>
<p><img src="Momocs_intro_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
</div>
<div id="import-misc" class="section level3">
<h3 class="hasAnchor">
<a href="#import-misc" class="anchor"></a>Import misc</h3>
<ul>
<li>If covariables are encoded in filenames, which is a good practice, eg if you have files named <code>spA_group7_ind4_VL.{txt|jpg|etc.}</code>, use <code>lf_structure</code>;</li>
<li>If you need rewriting rules on your <code>$fac</code>, <code>rw_rule</code> is your friend;</li>
<li>If you need to rescale imported coordinates, see <code>rescale</code>;</li>
<li>If you need to tie images (eg outlines) and <code>.txt</code> (eg coordinates of landmarks on them), see <code>tie_jpg_txt</code>.</li>
</ul>
</div>
<div id="save-from-r" class="section level3">
<h3 class="hasAnchor">
<a href="#save-from-r" class="anchor"></a>Save from R</h3>
<p>The best way to save a Momocs object is probably to use the base <code>save</code> function. You can call it back afterwards with <code>load</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">save</span>(bot, <span class="dt">file=</span><span class="st">"Bottles.rda"</span>)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="co"># closing R, going to the beach, back at work</span></a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="kw">load</span>(<span class="st">"Bottles.rda"</span>) <span class="co"># bot is back</span></a></code></pre></div>
</div>
<div id="export-from-r" class="section level3">
<h3 class="hasAnchor">
<a href="#export-from-r" class="anchor"></a>Export from R</h3>
<p>Any Momocs object, <code>Coo</code>s, <code>Coe</code>s, <code>PCA</code>s, etc. can be turned into a <code>data.frame</code> with <code>as_df</code>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">bot <span class="op">%&gt;%</span><span class="st"> </span>as_df</a>
<a class="sourceLine" id="cb99-2" data-line-number="2">bot <span class="op">%&gt;%</span><span class="st"> </span>efourier <span class="op">%&gt;%</span><span class="st"> </span>as_df</a>
<a class="sourceLine" id="cb99-3" data-line-number="3">bot <span class="op">%&gt;%</span><span class="st"> </span>efourier <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span>as_df</a></code></pre></div>
<pre><code>## # A tibble: 40 x 4
##    coo             type   fake     cs
##    &lt;list&gt;          &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt;
##  1 &lt;dbl [138 × 2]&gt; whisky a      335.
##  2 &lt;dbl [168 × 2]&gt; whisky a      307.
##  3 &lt;dbl [189 × 2]&gt; whisky a      220.
##  4 &lt;dbl [129 × 2]&gt; whisky a      245.
##  5 &lt;dbl [152 × 2]&gt; whisky a      277.
##  6 &lt;dbl [161 × 2]&gt; whisky a      210.
##  7 &lt;dbl [124 × 2]&gt; whisky a      267.
##  8 &lt;dbl [126 × 2]&gt; whisky a      251.
##  9 &lt;dbl [183 × 2]&gt; whisky a      240.
## 10 &lt;dbl [193 × 2]&gt; whisky a      325.
## # ... with 30 more rows
## # A tibble: 40 x 43
##    type   fake     cs    A1      A2     A3     A4      A5      A6       A7
##    &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 whisky a      335. 1.000 0.00677 0.0935 0.0137 0.0238  0.00859  0.00318
##  2 whisky a      307. 1.000 0.00737 0.0954 0.0145 0.0222  0.00667  0.00355
##  3 whisky a      220. 1.    0.0165  0.0757 0.0274 0.00988 0.0143  -0.00474
##  4 whisky a      245. 1.    0.00749 0.0962 0.0122 0.0229  0.00728  0.00550
##  5 whisky a      277. 1     0.0196  0.0928 0.0223 0.0153  0.0149   0.00252
##  6 whisky a      210. 1.000 0.0222  0.0690 0.0335 0.00932 0.0211  -0.00169
##  7 whisky a      267. 1.    0.00731 0.0911 0.0129 0.0231  0.0106   0.00458
##  8 whisky a      251. 1     0.00952 0.0857 0.0197 0.0129  0.00849 -0.00220
##  9 whisky a      240. 1     0.00959 0.0883 0.0227 0.0178  0.0107  -0.00152
## 10 whisky a      325. 1.000 0.00960 0.0919 0.0139 0.0201  0.00895  0.00240
## # ... with 30 more rows, and 33 more variables: A8 &lt;dbl&gt;, A9 &lt;dbl&gt;,
## #   A10 &lt;dbl&gt;, B1 &lt;dbl&gt;, B2 &lt;dbl&gt;, B3 &lt;dbl&gt;, B4 &lt;dbl&gt;, B5 &lt;dbl&gt;, B6 &lt;dbl&gt;,
## #   B7 &lt;dbl&gt;, B8 &lt;dbl&gt;, B9 &lt;dbl&gt;, B10 &lt;dbl&gt;, C1 &lt;dbl&gt;, C2 &lt;dbl&gt;, C3 &lt;dbl&gt;,
## #   C4 &lt;dbl&gt;, C5 &lt;dbl&gt;, C6 &lt;dbl&gt;, C7 &lt;dbl&gt;, C8 &lt;dbl&gt;, C9 &lt;dbl&gt;, C10 &lt;dbl&gt;,
## #   D1 &lt;dbl&gt;, D2 &lt;dbl&gt;, D3 &lt;dbl&gt;, D4 &lt;dbl&gt;, D5 &lt;dbl&gt;, D6 &lt;dbl&gt;, D7 &lt;dbl&gt;,
## #   D8 &lt;dbl&gt;, D9 &lt;dbl&gt;, D10 &lt;dbl&gt;
## # A tibble: 40 x 43
##    type   fake     cs     PC1      PC2      PC3      PC4      PC5      PC6
##    &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 whisky a      335. -0.0528 -2.31e-2  0.00245 -1.54e-2  6.05e-3 -9.73e-4
##  2 whisky a      307. -0.0369  7.25e-3 -0.00866 -9.21e-3 -2.77e-3 -2.82e-3
##  3 whisky a      220.  0.0809 -4.79e-3 -0.00222 -1.07e-2 -9.96e-4 -6.91e-3
##  4 whisky a      245. -0.0694  2.29e-3 -0.0158  -6.19e-3 -3.09e-4  3.86e-3
##  5 whisky a      277. -0.0112  4.76e-2 -0.0127   1.75e-2  1.35e-2 -6.99e-3
##  6 whisky a      210.  0.115  -1.70e-2 -0.0103  -9.12e-3  3.77e-4  1.26e-3
##  7 whisky a      267. -0.0443 -1.86e-2 -0.00496 -2.23e-4  1.90e-3  3.22e-3
##  8 whisky a      251.  0.0287  9.96e-3 -0.0114  -8.72e-3 -4.46e-3 -4.23e-3
##  9 whisky a      240.  0.0123  6.03e-4  0.00364 -8.19e-3 -3.91e-3  3.76e-4
## 10 whisky a      325. -0.0458  5.64e-3 -0.00889 -5.25e-3  3.99e-3 -2.42e-3
## # ... with 30 more rows, and 34 more variables: PC7 &lt;dbl&gt;, PC8 &lt;dbl&gt;,
## #   PC9 &lt;dbl&gt;, PC10 &lt;dbl&gt;, PC11 &lt;dbl&gt;, PC12 &lt;dbl&gt;, PC13 &lt;dbl&gt;, PC14 &lt;dbl&gt;,
## #   PC15 &lt;dbl&gt;, PC16 &lt;dbl&gt;, PC17 &lt;dbl&gt;, PC18 &lt;dbl&gt;, PC19 &lt;dbl&gt;,
## #   PC20 &lt;dbl&gt;, PC21 &lt;dbl&gt;, PC22 &lt;dbl&gt;, PC23 &lt;dbl&gt;, PC24 &lt;dbl&gt;,
## #   PC25 &lt;dbl&gt;, PC26 &lt;dbl&gt;, PC27 &lt;dbl&gt;, PC28 &lt;dbl&gt;, PC29 &lt;dbl&gt;,
## #   PC30 &lt;dbl&gt;, PC31 &lt;dbl&gt;, PC32 &lt;dbl&gt;, PC33 &lt;dbl&gt;, PC34 &lt;dbl&gt;,
## #   PC35 &lt;dbl&gt;, PC36 &lt;dbl&gt;, PC37 &lt;dbl&gt;, PC38 &lt;dbl&gt;, PC39 &lt;dbl&gt;, PC40 &lt;dbl&gt;</code></pre>
<p>If the heretic you want to exit R to do stats elsewhere, <code>export</code> is your friend:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">bot <span class="op">%&gt;%</span><span class="st"> </span>efourier <span class="op">%&gt;%</span><span class="st"> </span>export</a>
<a class="sourceLine" id="cb101-2" data-line-number="2">bot <span class="op">%&gt;%</span><span class="st"> </span>efourier <span class="op">%&gt;%</span><span class="st"> </span>PCA <span class="op">%&gt;%</span><span class="st"> </span>export</a></code></pre></div>
<p>But, of course, you can directly access information within the Momocs objects; try the following:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="co"># from Coo objects</span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2">bot<span class="op">$</span>coo <span class="co"># list of matrices (of xy coordinates)</span></a>
<a class="sourceLine" id="cb102-3" data-line-number="3">bot<span class="op">$</span>fac <span class="co"># data.frame for covariates</span></a>
<a class="sourceLine" id="cb102-4" data-line-number="4"></a>
<a class="sourceLine" id="cb102-5" data-line-number="5"><span class="co"># from Coe objects</span></a>
<a class="sourceLine" id="cb102-6" data-line-number="6">bot.f<span class="op">$</span>coe <span class="co"># matrix of coefficients</span></a>
<a class="sourceLine" id="cb102-7" data-line-number="7">bot.f<span class="op">$</span>fac <span class="co"># data.frame for covariates</span></a>
<a class="sourceLine" id="cb102-8" data-line-number="8"></a>
<a class="sourceLine" id="cb102-9" data-line-number="9"><span class="co"># from PCA objects</span></a>
<a class="sourceLine" id="cb102-10" data-line-number="10">bot.p<span class="op">$</span>x        <span class="co"># scores</span></a>
<a class="sourceLine" id="cb102-11" data-line-number="11">bot.p<span class="op">$</span>rotation <span class="co"># rotation matrix</span></a></code></pre></div>
</div>
</div>
<div id="graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h2>
<p>Most graphics are currently being rewritten, either to pure <code>ggplot2</code> or using grindr. See the dedicated embryo of vignette: see <code><a href="../articles/Momocs_grindr.html">vignette("Momocs_grindr")</a></code>.</p>
<div id="tps_-thin-plate-splines" class="section level3">
<h3 class="hasAnchor">
<a href="#tps_-thin-plate-splines" class="anchor"></a><code>tps_*</code>: Thin Plate Splines</h3>
<p>TPS have not been presented before but here there are:</p>
<pre><code><a href="../reference/tps_grid.html">tps_grid(beer, whisky)
tps_arr(beer, whisky)
tps_iso(beer, whisky)</a></code></pre>
<p>Again, plenty options in <code>?tps_*</code>.</p>
<p>You may also like lolliplots and friends:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw"><a href="../reference/coo_lolli.html">coo_lolli</a></span>(beer, whisky); <span class="kw">title</span>(<span class="st">"coo_lolli"</span>)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="kw"><a href="../reference/coo_arrows.html">coo_arrows</a></span>(beer, whisky); <span class="kw">title</span>(<span class="st">"coo_arrow"</span>)</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="co"># an example with coo_ruban</span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="kw"><a href="../reference/coo_plot.html">coo_plot</a></span>(beer) <span class="co"># to get the first plot</span></a>
<a class="sourceLine" id="cb104-6" data-line-number="6"><span class="kw"><a href="../reference/coo_ruban.html">coo_ruban</a></span>(beer, <span class="kw"><a href="../reference/edm.html">edm</a></span>(beer, whisky), <span class="dt">lwd=</span><span class="dv">8</span>) <span class="co"># we add ruban based from deviations</span></a>
<a class="sourceLine" id="cb104-7" data-line-number="7"><span class="kw"><a href="../reference/coo_draw.html">coo_draw</a></span>(whisky)</a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="kw">title</span>(<span class="st">"coo_ruban"</span>)</a></code></pre></div>
</div>
<div id="color-palettes" class="section level3">
<h3 class="hasAnchor">
<a href="#color-palettes" class="anchor"></a>Color palettes</h3>
<ul>
<li>Nice palettes are bundled with Momocs, see <code>?palettes</code>.</li>
</ul>
</div>
</div>
<div id="frequently-asked-questions" class="section level2">
<h2 class="hasAnchor">
<a href="#frequently-asked-questions" class="anchor"></a>Frequently asked questions</h2>
<p>See <code><a href="../articles/Momocs_FAQ.html">vignette("Momocs_FAQ")</a></code>.</p>
<hr>
<ul>
<li>Done with love by Vincent Bonhomme <code>&lt;bonhomme.vincent@gmail.com&gt;</code>.</li>
<li>Help/suggestions/review/critics are welcome.</li>
<li>Sources are <a href="https://github.com/MomX/Momocs/tree/master/vignettes">there</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#news">News</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#design">Design</a></li>
      <li><a href="#single-shapes">Single shapes</a></li>
      <li><a href="#morphometrics">Morphometrics</a></li>
      <li><a href="#multivariate-statistics">Multivariate statistics</a></li>
      <li><a href="#manipulating-objects">Manipulating objects</a></li>
      <li><a href="#babel-importexport">Babel import/export</a></li>
      <li><a href="#graphics">Graphics</a></li>
      <li><a href="#frequently-asked-questions">Frequently asked questions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.vincentbonhomme.fr">Vincent Bonhomme</a>, Julien Claude.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
